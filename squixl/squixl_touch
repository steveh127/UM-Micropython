from SQUiXL import touch

class Touch():
	def __init__(self):
		self.touch = touch
		self.touched = False
		self.point = -1,-1
		asyncio.create_task(self.check())
		self.targets = []
	
	def add_target(self,rectangle,action):
		x,y,width,height = rectangle
		box = x,x+width,y,y+height
		self.targets.append((box,action))

	async def check(self):
		last_y = last_x = -1
		while True:
			n, points = self.touch.read_points()
			for i in range(0, n):
				if last_y != points[i][0] and last_x != points[i][1]:
					point = points[i][1],points[i][0]
					self.check_targets(point)
					last_x = points[i][1]
					last_y = points[i][0]
			await asyncio.sleep(0.1)
	
	def check_targets(self,point):
		for target in self.targets:
			x,y = point
			x_min,x_max,y_min,y_max = target[0]
			if (x > x_min) and (x < x_max) and (y > y_min) and (y < y_max):
				target[1]()
				break
